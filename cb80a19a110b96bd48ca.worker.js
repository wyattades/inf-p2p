!function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/inf-p2p/",r(r.s=20)}([function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){t.exports=r(11)},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){(function(e){t.exports=e}).call(this,{})},function(t,e){function r(t,e,r,i,s,n,o){try{var a=t[n](o),h=a.value}catch(t){return void r(t)}a.done?e(h):Promise.resolve(h).then(i,s)}t.exports=function(t){return function(){var e=this,i=arguments;return new Promise(function(s,n){var o=t.apply(e,i);function a(t){r(o,s,n,a,h,"next",t)}function h(t){r(o,s,n,a,h,"throw",t)}a(void 0)})}}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}},function(t,e){t.exports=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}},function(t,e,r){var i=r(12),s=r(13),n=r(14),o=r(15),a=r(16),h=r(17),c=r(18);c.alea=i,c.xor128=s,c.xorwow=n,c.xorshift7=o,c.xor4096=a,c.tychei=h,t.exports=c},function(t,e,r){var i;!function(){"use strict";var s=.5*(Math.sqrt(3)-1),n=(3-Math.sqrt(3))/6,o=1/6,a=(Math.sqrt(5)-1)/4,h=(5-Math.sqrt(5))/20;function c(t){var e;e="function"==typeof t?t:t?function(){var t=0,e=0,r=0,i=1,s=(n=4022871197,function(t){t=t.toString();for(var e=0;e<t.length;e++){var r=.02519603282416938*(n+=t.charCodeAt(e));r-=n=r>>>0,n=(r*=n)>>>0,n+=4294967296*(r-=n)}return 2.3283064365386963e-10*(n>>>0)});var n;t=s(" "),e=s(" "),r=s(" ");for(var o=0;o<arguments.length;o++)(t-=s(arguments[o]))<0&&(t+=1),(e-=s(arguments[o]))<0&&(e+=1),(r-=s(arguments[o]))<0&&(r+=1);return s=null,function(){var s=2091639*t+2.3283064365386963e-10*i;return t=e,e=r,r=s-(i=0|s)}}(t):Math.random,this.p=u(e),this.perm=new Uint8Array(512),this.permMod12=new Uint8Array(512);for(var r=0;r<512;r++)this.perm[r]=this.p[255&r],this.permMod12[r]=this.perm[r]%12}function u(t){var e,r=new Uint8Array(256);for(e=0;e<256;e++)r[e]=e;for(e=0;e<255;e++){var i=e+~~(t()*(256-e)),s=r[e];r[e]=r[i],r[i]=s}return r}c.prototype={grad3:new Float32Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]),grad4:new Float32Array([0,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,1,0,1,1,1,0,1,-1,1,0,-1,1,1,0,-1,-1,-1,0,1,1,-1,0,1,-1,-1,0,-1,1,-1,0,-1,-1,1,1,0,1,1,1,0,-1,1,-1,0,1,1,-1,0,-1,-1,1,0,1,-1,1,0,-1,-1,-1,0,1,-1,-1,0,-1,1,1,1,0,1,1,-1,0,1,-1,1,0,1,-1,-1,0,-1,1,1,0,-1,1,-1,0,-1,-1,1,0,-1,-1,-1,0]),noise2D:function(t,e){var r,i,o=this.permMod12,a=this.perm,h=this.grad3,c=0,u=0,l=0,d=(t+e)*s,m=Math.floor(t+d),p=Math.floor(e+d),f=(m+p)*n,y=t-(m-f),x=e-(p-f);y>x?(r=1,i=0):(r=0,i=1);var g=y-r+n,b=x-i+n,v=y-1+2*n,w=x-1+2*n,M=255&m,z=255&p,_=.5-y*y-x*x;if(_>=0){var A=3*o[M+a[z]];c=(_*=_)*_*(h[A]*y+h[A+1]*x)}var S=.5-g*g-b*b;if(S>=0){var k=3*o[M+r+a[z+i]];u=(S*=S)*S*(h[k]*g+h[k+1]*b)}var E=.5-v*v-w*w;if(E>=0){var N=3*o[M+1+a[z+1]];l=(E*=E)*E*(h[N]*v+h[N+1]*w)}return 70*(c+u+l)},noise3D:function(t,e,r){var i,s,n,a,h,c,u,l,d,m,p=this.permMod12,f=this.perm,y=this.grad3,x=(t+e+r)*(1/3),g=Math.floor(t+x),b=Math.floor(e+x),v=Math.floor(r+x),w=(g+b+v)*o,M=t-(g-w),z=e-(b-w),_=r-(v-w);M>=z?z>=_?(h=1,c=0,u=0,l=1,d=1,m=0):M>=_?(h=1,c=0,u=0,l=1,d=0,m=1):(h=0,c=0,u=1,l=1,d=0,m=1):z<_?(h=0,c=0,u=1,l=0,d=1,m=1):M<_?(h=0,c=1,u=0,l=0,d=1,m=1):(h=0,c=1,u=0,l=1,d=1,m=0);var A=M-h+o,S=z-c+o,k=_-u+o,E=M-l+2*o,N=z-d+2*o,B=_-m+2*o,U=M-1+.5,C=z-1+.5,O=_-1+.5,T=255&g,V=255&b,R=255&v,F=.6-M*M-z*z-_*_;if(F<0)i=0;else{var j=3*p[T+f[V+f[R]]];i=(F*=F)*F*(y[j]*M+y[j+1]*z+y[j+2]*_)}var P=.6-A*A-S*S-k*k;if(P<0)s=0;else{var q=3*p[T+h+f[V+c+f[R+u]]];s=(P*=P)*P*(y[q]*A+y[q+1]*S+y[q+2]*k)}var D=.6-E*E-N*N-B*B;if(D<0)n=0;else{var I=3*p[T+l+f[V+d+f[R+m]]];n=(D*=D)*D*(y[I]*E+y[I+1]*N+y[I+2]*B)}var L=.6-U*U-C*C-O*O;if(L<0)a=0;else{var G=3*p[T+1+f[V+1+f[R+1]]];a=(L*=L)*L*(y[G]*U+y[G+1]*C+y[G+2]*O)}return 32*(i+s+n+a)},noise4D:function(t,e,r,i){var s,n,o,c,u,l,d,m,p,f,y,x,g,b,v,w,M,z=this.perm,_=this.grad4,A=(t+e+r+i)*a,S=Math.floor(t+A),k=Math.floor(e+A),E=Math.floor(r+A),N=Math.floor(i+A),B=(S+k+E+N)*h,U=t-(S-B),C=e-(k-B),O=r-(E-B),T=i-(N-B),V=0,R=0,F=0,j=0;U>C?V++:R++,U>O?V++:F++,U>T?V++:j++,C>O?R++:F++,C>T?R++:j++,O>T?F++:j++;var P=U-(l=V>=3?1:0)+h,q=C-(d=R>=3?1:0)+h,D=O-(m=F>=3?1:0)+h,I=T-(p=j>=3?1:0)+h,L=U-(f=V>=2?1:0)+2*h,G=C-(y=R>=2?1:0)+2*h,X=O-(x=F>=2?1:0)+2*h,H=T-(g=j>=2?1:0)+2*h,W=U-(b=V>=1?1:0)+3*h,Y=C-(v=R>=1?1:0)+3*h,Z=O-(w=F>=1?1:0)+3*h,Q=T-(M=j>=1?1:0)+3*h,J=U-1+4*h,$=C-1+4*h,K=O-1+4*h,tt=T-1+4*h,et=255&S,rt=255&k,it=255&E,st=255&N,nt=.6-U*U-C*C-O*O-T*T;if(nt<0)s=0;else{var ot=z[et+z[rt+z[it+z[st]]]]%32*4;s=(nt*=nt)*nt*(_[ot]*U+_[ot+1]*C+_[ot+2]*O+_[ot+3]*T)}var at=.6-P*P-q*q-D*D-I*I;if(at<0)n=0;else{var ht=z[et+l+z[rt+d+z[it+m+z[st+p]]]]%32*4;n=(at*=at)*at*(_[ht]*P+_[ht+1]*q+_[ht+2]*D+_[ht+3]*I)}var ct=.6-L*L-G*G-X*X-H*H;if(ct<0)o=0;else{var ut=z[et+f+z[rt+y+z[it+x+z[st+g]]]]%32*4;o=(ct*=ct)*ct*(_[ut]*L+_[ut+1]*G+_[ut+2]*X+_[ut+3]*H)}var lt=.6-W*W-Y*Y-Z*Z-Q*Q;if(lt<0)c=0;else{var dt=z[et+b+z[rt+v+z[it+w+z[st+M]]]]%32*4;c=(lt*=lt)*lt*(_[dt]*W+_[dt+1]*Y+_[dt+2]*Z+_[dt+3]*Q)}var mt=.6-J*J-$*$-K*K-tt*tt;if(mt<0)u=0;else{var pt=z[et+1+z[rt+1+z[it+1+z[st+1]]]]%32*4;u=(mt*=mt)*mt*(_[pt]*J+_[pt+1]*$+_[pt+2]*K+_[pt+3]*tt)}return 27*(s+n+o+c+u)}},c._buildPermutationTable=u,void 0===(i=function(){return c}.call(e,r,e,t))||(t.exports=i),e.SimplexNoise=c,t.exports=c}()},function(t,e){var r=4,i=.001,s=1e-7,n=10,o=11,a=1/(o-1),h="function"==typeof Float32Array;function c(t,e){return 1-3*e+3*t}function u(t,e){return 3*e-6*t}function l(t){return 3*t}function d(t,e,r){return((c(e,r)*t+u(e,r))*t+l(e))*t}function m(t,e,r){return 3*c(e,r)*t*t+2*u(e,r)*t+l(e)}function p(t){return t}t.exports=function(t,e,c,u){if(!(0<=t&&t<=1&&0<=c&&c<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===e&&c===u)return p;for(var l=h?new Float32Array(o):new Array(o),f=0;f<o;++f)l[f]=d(f*a,t,c);function y(e){for(var h=0,u=1,p=o-1;u!==p&&l[u]<=e;++u)h+=a;var f=h+(e-l[--u])/(l[u+1]-l[u])*a,y=m(f,t,c);return y>=i?function(t,e,i,s){for(var n=0;n<r;++n){var o=m(e,i,s);if(0===o)return e;e-=(d(e,i,s)-t)/o}return e}(e,f,t,c):0===y?f:function(t,e,r,i,o){var a,h,c=0;do{(a=d(h=e+(r-e)/2,i,o)-t)>0?r=h:e=h}while(Math.abs(a)>s&&++c<n);return h}(e,h,h+a,t,c)}return function(t){return 0===t?0:1===t?1:d(y(t),e,u)}}},function(t,e,r){var i=function(t){"use strict";var e,r=Object.prototype,i=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},n=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function c(t,e,r,i){var s=e&&e.prototype instanceof y?e:y,n=Object.create(s.prototype),o=new E(i||[]);return n._invoke=function(t,e,r){var i=l;return function(s,n){if(i===m)throw new Error("Generator is already running");if(i===p){if("throw"===s)throw n;return B()}for(r.method=s,r.arg=n;;){var o=r.delegate;if(o){var a=A(o,r);if(a){if(a===f)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===l)throw i=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=m;var h=u(t,e,r);if("normal"===h.type){if(i=r.done?p:d,h.arg===f)continue;return{value:h.arg,done:r.done}}"throw"===h.type&&(i=p,r.method="throw",r.arg=h.arg)}}}(t,r,o),n}function u(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l="suspendedStart",d="suspendedYield",m="executing",p="completed",f={};function y(){}function x(){}function g(){}var b={};b[n]=function(){return this};var v=Object.getPrototypeOf,w=v&&v(v(N([])));w&&w!==r&&i.call(w,n)&&(b=w);var M=g.prototype=y.prototype=Object.create(b);function z(t){["next","throw","return"].forEach(function(e){h(t,e,function(t){return this._invoke(e,t)})})}function _(t,e){var r;this._invoke=function(s,n){function o(){return new e(function(r,o){!function r(s,n,o,a){var h=u(t[s],t,n);if("throw"!==h.type){var c=h.arg,l=c.value;return l&&"object"==typeof l&&i.call(l,"__await")?e.resolve(l.__await).then(function(t){r("next",t,o,a)},function(t){r("throw",t,o,a)}):e.resolve(l).then(function(t){c.value=t,o(c)},function(t){return r("throw",t,o,a)})}a(h.arg)}(s,n,r,o)})}return r=r?r.then(o,o):o()}}function A(t,r){var i=t.iterator[r.method];if(i===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,A(t,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var s=u(i,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,f;var n=s.arg;return n?n.done?(r[t.resultName]=n.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,f):n:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}function S(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function N(t){if(t){var r=t[n];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,o=function r(){for(;++s<t.length;)if(i.call(t,s))return r.value=t[s],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}return{next:B}}function B(){return{value:e,done:!0}}return x.prototype=M.constructor=g,g.constructor=x,x.displayName=h(g,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,h(t,a,"GeneratorFunction")),t.prototype=Object.create(M),t},t.awrap=function(t){return{__await:t}},z(_.prototype),_.prototype[o]=function(){return this},t.AsyncIterator=_,t.async=function(e,r,i,s,n){void 0===n&&(n=Promise);var o=new _(c(e,r,i,s),n);return t.isGeneratorFunction(r)?o:o.next().then(function(t){return t.done?t.value:o.next()})},z(M),h(M,a,"Generator"),M[n]=function(){return this},M.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var i=e.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}},t.values=N,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function s(i,s){return a.type="throw",a.arg=t,r.next=i,s&&(r.method="next",r.arg=e),!!s}for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var h=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(h&&c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(h){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var n=s;break}}n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc&&(n=null);var o=n?n.completion:{};return o.type=t,o.arg=e,n?(this.method="next",this.next=n.finallyLoc,f):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var i=r.completion;if("throw"===i.type){var s=i.arg;k(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,i){return this.delegate={iterator:N(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=e),f}},t}(t.exports);try{regeneratorRuntime=i}catch(t){Function("r","regeneratorRuntime = r")(i)}},function(t,e,r){(function(t){var i;!function(t,s,n){function o(t){var e,r=this,i=(e=4022871197,function(t){t=String(t);for(var r=0;r<t.length;r++){var i=.02519603282416938*(e+=t.charCodeAt(r));i-=e=i>>>0,e=(i*=e)>>>0,e+=4294967296*(i-=e)}return 2.3283064365386963e-10*(e>>>0)});r.next=function(){var t=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=t-(r.c=0|t)},r.c=1,r.s0=i(" "),r.s1=i(" "),r.s2=i(" "),r.s0-=i(t),r.s0<0&&(r.s0+=1),r.s1-=i(t),r.s1<0&&(r.s1+=1),r.s2-=i(t),r.s2<0&&(r.s2+=1),i=null}function a(t,e){return e.c=t.c,e.s0=t.s0,e.s1=t.s1,e.s2=t.s2,e}function h(t,e){var r=new o(t),i=e&&e.state,s=r.next;return s.int32=function(){return 4294967296*r.next()|0},s.double=function(){return s()+11102230246251565e-32*(2097152*s()|0)},s.quick=s,i&&("object"==typeof i&&a(i,r),s.state=function(){return a(r,{})}),s}s&&s.exports?s.exports=h:r(0)&&r(3)?void 0===(i=function(){return h}.call(e,r,e,s))||(s.exports=i):this.alea=h}(0,t,r(0))}).call(this,r(2)(t))},function(t,e,r){(function(t){var i;!function(t,s,n){function o(t){var e=this,r="";e.x=0,e.y=0,e.z=0,e.w=0,e.next=function(){var t=e.x^e.x<<11;return e.x=e.y,e.y=e.z,e.z=e.w,e.w^=e.w>>>19^t^t>>>8},t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e}function h(t,e){var r=new o(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&("object"==typeof i&&a(i,r),s.state=function(){return a(r,{})}),s}s&&s.exports?s.exports=h:r(0)&&r(3)?void 0===(i=function(){return h}.call(e,r,e,s))||(s.exports=i):this.xor128=h}(0,t,r(0))}).call(this,r(2)(t))},function(t,e,r){(function(t){var i;!function(t,s,n){function o(t){var e=this,r="";e.next=function(){var t=e.x^e.x>>>2;return e.x=e.y,e.y=e.z,e.z=e.w,e.w=e.v,(e.d=e.d+362437|0)+(e.v=e.v^e.v<<4^t^t<<1)|0},e.x=0,e.y=0,e.z=0,e.w=0,e.v=0,t===(0|t)?e.x=t:r+=t;for(var i=0;i<r.length+64;i++)e.x^=0|r.charCodeAt(i),i==r.length&&(e.d=e.x<<10^e.x>>>4),e.next()}function a(t,e){return e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e.v=t.v,e.d=t.d,e}function h(t,e){var r=new o(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&("object"==typeof i&&a(i,r),s.state=function(){return a(r,{})}),s}s&&s.exports?s.exports=h:r(0)&&r(3)?void 0===(i=function(){return h}.call(e,r,e,s))||(s.exports=i):this.xorwow=h}(0,t,r(0))}).call(this,r(2)(t))},function(t,e,r){(function(t){var i;!function(t,s,n){function o(t){var e=this;e.next=function(){var t,r,i=e.x,s=e.i;return t=i[s],r=(t^=t>>>7)^t<<24,r^=(t=i[s+1&7])^t>>>10,r^=(t=i[s+3&7])^t>>>3,r^=(t=i[s+4&7])^t<<7,t=i[s+7&7],r^=(t^=t<<13)^t<<9,i[s]=r,e.i=s+1&7,r},function(t,e){var r,i=[];if(e===(0|e))i[0]=e;else for(e=""+e,r=0;r<e.length;++r)i[7&r]=i[7&r]<<15^e.charCodeAt(r)+i[r+1&7]<<13;for(;i.length<8;)i.push(0);for(r=0;r<8&&0===i[r];++r);for(8==r?i[7]=-1:i[r],t.x=i,t.i=0,r=256;r>0;--r)t.next()}(e,t)}function a(t,e){return e.x=t.x.slice(),e.i=t.i,e}function h(t,e){null==t&&(t=+new Date);var r=new o(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&(i.x&&a(i,r),s.state=function(){return a(r,{})}),s}s&&s.exports?s.exports=h:r(0)&&r(3)?void 0===(i=function(){return h}.call(e,r,e,s))||(s.exports=i):this.xorshift7=h}(0,t,r(0))}).call(this,r(2)(t))},function(t,e,r){(function(t){var i;!function(t,s,n){function o(t){var e=this;e.next=function(){var t,r,i=e.w,s=e.X,n=e.i;return e.w=i=i+1640531527|0,r=s[n+34&127],t=s[n=n+1&127],r^=r<<13,t^=t<<17,r^=r>>>15,t^=t>>>12,r=s[n]=r^t,e.i=n,r+(i^i>>>16)|0},function(t,e){var r,i,s,n,o,a=[],h=128;for(e===(0|e)?(i=e,e=null):(e+="\0",i=0,h=Math.max(h,e.length)),s=0,n=-32;n<h;++n)e&&(i^=e.charCodeAt((n+32)%e.length)),0===n&&(o=i),i^=i<<10,i^=i>>>15,i^=i<<4,i^=i>>>13,n>=0&&(o=o+1640531527|0,s=0==(r=a[127&n]^=i+o)?s+1:0);for(s>=128&&(a[127&(e&&e.length||0)]=-1),s=127,n=512;n>0;--n)i=a[s+34&127],r=a[s=s+1&127],i^=i<<13,r^=r<<17,i^=i>>>15,r^=r>>>12,a[s]=i^r;t.w=o,t.X=a,t.i=s}(e,t)}function a(t,e){return e.i=t.i,e.w=t.w,e.X=t.X.slice(),e}function h(t,e){null==t&&(t=+new Date);var r=new o(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&(i.X&&a(i,r),s.state=function(){return a(r,{})}),s}s&&s.exports?s.exports=h:r(0)&&r(3)?void 0===(i=function(){return h}.call(e,r,e,s))||(s.exports=i):this.xor4096=h}(0,t,r(0))}).call(this,r(2)(t))},function(t,e,r){(function(t){var i;!function(t,s,n){function o(t){var e=this,r="";e.next=function(){var t=e.b,r=e.c,i=e.d,s=e.a;return t=t<<25^t>>>7^r,r=r-i|0,i=i<<24^i>>>8^s,s=s-t|0,e.b=t=t<<20^t>>>12^r,e.c=r=r-i|0,e.d=i<<16^r>>>16^s,e.a=s-t|0},e.a=0,e.b=0,e.c=-1640531527,e.d=1367130551,t===Math.floor(t)?(e.a=t/4294967296|0,e.b=0|t):r+=t;for(var i=0;i<r.length+20;i++)e.b^=0|r.charCodeAt(i),e.next()}function a(t,e){return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e}function h(t,e){var r=new o(t),i=e&&e.state,s=function(){return(r.next()>>>0)/4294967296};return s.double=function(){do{var t=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===t);return t},s.int32=r.next,s.quick=s,i&&("object"==typeof i&&a(i,r),s.state=function(){return a(r,{})}),s}s&&s.exports?s.exports=h:r(0)&&r(3)?void 0===(i=function(){return h}.call(e,r,e,s))||(s.exports=i):this.tychei=h}(0,t,r(0))}).call(this,r(2)(t))},function(t,e,r){var i;!function(s,n,o){var a,h=256,c=6,u="random",l=o.pow(h,c),d=o.pow(2,52),m=2*d,p=h-1;function f(t,e,r){var i=[],p=g(function t(e,r){var i,s=[],n=typeof e;if(r&&"object"==n)for(i in e)try{s.push(t(e[i],r-1))}catch(t){}return s.length?s:"string"==n?e:e+"\0"}((e=1==e?{entropy:!0}:e||{}).entropy?[t,b(n)]:null==t?function(){try{var t;return a&&(t=a.randomBytes)?t=t(h):(t=new Uint8Array(h),(s.crypto||s.msCrypto).getRandomValues(t)),b(t)}catch(t){var e=s.navigator,r=e&&e.plugins;return[+new Date,s,r,s.screen,b(n)]}}():t,3),i),f=new y(i),v=function(){for(var t=f.g(c),e=l,r=0;t<d;)t=(t+r)*h,e*=h,r=f.g(1);for(;t>=m;)t/=2,e/=2,r>>>=1;return(t+r)/e};return v.int32=function(){return 0|f.g(4)},v.quick=function(){return f.g(4)/4294967296},v.double=v,g(b(f.S),n),(e.pass||r||function(t,e,r,i){return i&&(i.S&&x(i,f),t.state=function(){return x(f,{})}),r?(o[u]=t,e):t})(v,p,"global"in e?e.global:this==o,e.state)}function y(t){var e,r=t.length,i=this,s=0,n=i.i=i.j=0,o=i.S=[];for(r||(t=[r++]);s<h;)o[s]=s++;for(s=0;s<h;s++)o[s]=o[n=p&n+t[s%r]+(e=o[s])],o[n]=e;(i.g=function(t){for(var e,r=0,s=i.i,n=i.j,o=i.S;t--;)e=o[s=p&s+1],r=r*h+o[p&(o[s]=o[n=p&n+e])+(o[n]=e)];return i.i=s,i.j=n,r})(h)}function x(t,e){return e.i=t.i,e.j=t.j,e.S=t.S.slice(),e}function g(t,e){for(var r,i=t+"",s=0;s<i.length;)e[p&s]=p&(r^=19*e[p&s])+i.charCodeAt(s++);return b(e)}function b(t){return String.fromCharCode.apply(0,t)}if(g(o.random(),n),t.exports){t.exports=f;try{a=r(19)}catch(t){}}else void 0===(i=function(){return f}.call(e,r,e,t))||(t.exports=i)}("undefined"!=typeof self?self:this,[],Math)},function(t,e){},function(t,e,r){"use strict";r.r(e);var i=r(1),s=r.n(i),n=r(4),o=r.n(n),a=r(7),h=r.n(a),c=r(5),u=r.n(c),l=r(6),d=r.n(l);function m(){}Object.assign(m.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});const r=this._listeners;void 0===r[t]&&(r[t]=[]),-1===r[t].indexOf(e)&&r[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;const r=this._listeners;return void 0!==r[t]&&-1!==r[t].indexOf(e)},removeEventListener:function(t,e){if(void 0===this._listeners)return;const r=this._listeners[t];if(void 0!==r){const t=r.indexOf(e);-1!==t&&r.splice(t,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const e=this._listeners[t.type];if(void 0!==e){t.target=this;const r=e.slice(0);for(let e=0,i=r.length;e<i;e++)r[e].call(this,t)}}});const p=[];for(let t=0;t<256;t++)p[t]=(t<16?"0":"")+t.toString(16);let f=1234567;const y={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,e=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(p[255&t]+p[t>>8&255]+p[t>>16&255]+p[t>>24&255]+"-"+p[255&e]+p[e>>8&255]+"-"+p[e>>16&15|64]+p[e>>24&255]+"-"+p[63&r|128]+p[r>>8&255]+"-"+p[r>>16&255]+p[r>>24&255]+p[255&i]+p[i>>8&255]+p[i>>16&255]+p[i>>24&255]).toUpperCase()},clamp:function(t,e,r){return Math.max(e,Math.min(r,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,r,i,s){return i+(t-e)*(s-i)/(r-e)},lerp:function(t,e,r){return(1-r)*t+r*e},smoothstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*(3-2*t)},smootherstep:function(t,e,r){return t<=e?0:t>=r?1:(t=(t-e)/(r-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(f=t%2147483647),((f=16807*f%2147483647)-1)/2147483646},degToRad:function(t){return t*y.DEG2RAD},radToDeg:function(t){return t*y.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,e,r,i,s){const n=Math.cos,o=Math.sin,a=n(r/2),h=o(r/2),c=n((e+i)/2),u=o((e+i)/2),l=n((e-i)/2),d=o((e-i)/2),m=n((i-e)/2),p=o((i-e)/2);switch(s){case"XYX":t.set(a*u,h*l,h*d,a*c);break;case"YZY":t.set(h*d,a*u,h*l,a*c);break;case"ZXZ":t.set(h*l,h*d,a*u,a*c);break;case"XZX":t.set(a*u,h*p,h*m,a*c);break;case"YXY":t.set(h*m,a*u,h*p,a*c);break;case"ZYZ":t.set(h*p,h*m,a*u,a*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}},x={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},g={h:0,s:0,l:0},b={h:0,s:0,l:0};function v(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+6*(e-t)*(2/3-r):t}function w(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function M(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}class z{constructor(t,e,r){return Object.defineProperty(this,"isColor",{value:!0}),void 0===e&&void 0===r?this.set(t):this.setRGB(t,e,r)}set(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this}setRGB(t,e,r){return this.r=t,this.g=e,this.b=r,this}setHSL(t,e,r){if(t=y.euclideanModulo(t,1),e=y.clamp(e,0,1),r=y.clamp(r,0,1),0===e)this.r=this.g=this.b=r;else{const i=r<=.5?r*(1+e):r+e-r*e,s=2*r-i;this.r=v(s,i,t+1/3),this.g=v(s,i,t),this.b=v(s,i,t-1/3)}return this}setStyle(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let t;const i=r[1],s=r[2];switch(i){case"rgb":case"rgba":if(t=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(t[1],10))/255,this.g=Math.min(255,parseInt(t[2],10))/255,this.b=Math.min(255,parseInt(t[3],10))/255,e(t[4]),this;if(t=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(t[1],10))/100,this.g=Math.min(100,parseInt(t[2],10))/100,this.b=Math.min(100,parseInt(t[3],10))/100,e(t[4]),this;break;case"hsl":case"hsla":if(t=/^(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s)){const r=parseFloat(t[1])/360,i=parseInt(t[2],10)/100,s=parseInt(t[3],10)/100;return e(t[4]),this.setHSL(r,i,s)}}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){const t=r[1],e=t.length;if(3===e)return this.r=parseInt(t.charAt(0)+t.charAt(0),16)/255,this.g=parseInt(t.charAt(1)+t.charAt(1),16)/255,this.b=parseInt(t.charAt(2)+t.charAt(2),16)/255,this;if(6===e)return this.r=parseInt(t.charAt(0)+t.charAt(1),16)/255,this.g=parseInt(t.charAt(2)+t.charAt(3),16)/255,this.b=parseInt(t.charAt(4)+t.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this}setColorName(t){const e=x[t];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copyGammaToLinear(t,e=2){return this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this}copyLinearToGamma(t,e=2){const r=e>0?1/e:1;return this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this}convertGammaToLinear(t){return this.copyGammaToLinear(this,t),this}convertLinearToGamma(t){return this.copyLinearToGamma(this,t),this}copySRGBToLinear(t){return this.r=w(t.r),this.g=w(t.g),this.b=w(t.b),this}copyLinearToSRGB(t){return this.r=M(t.r),this.g=M(t.g),this.b=M(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const e=this.r,r=this.g,i=this.b,s=Math.max(e,r,i),n=Math.min(e,r,i);let o,a;const h=(n+s)/2;if(n===s)o=0,a=0;else{const t=s-n;switch(a=h<=.5?t/(s+n):t/(2-s-n),s){case e:o=(r-i)/t+(r<i?6:0);break;case r:o=(i-e)/t+2;break;case i:o=(e-r)/t+4}o/=6}return t.h=o,t.s=a,t.l=h,t}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(t,e,r){return this.getHSL(g),g.h+=t,g.s+=e,g.l+=r,this.setHSL(g.h,g.s,g.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpHSL(t,e){this.getHSL(g),t.getHSL(b);const r=y.lerp(g.h,b.h,e),i=y.lerp(g.s,b.s,e),s=y.lerp(g.l,b.l,e);return this.setHSL(r,i,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}z.NAMES=x,z.prototype.r=1,z.prototype.g=1,z.prototype.b=1;class _{constructor(t=0,e=0,r=0,i=1){Object.defineProperty(this,"isQuaternion",{value:!0}),this._x=t,this._y=e,this._z=r,this._w=i}static slerp(t,e,r,i){return r.copy(t).slerp(e,i)}static slerpFlat(t,e,r,i,s,n,o){let a=r[i+0],h=r[i+1],c=r[i+2],u=r[i+3];const l=s[n+0],d=s[n+1],m=s[n+2],p=s[n+3];if(u!==p||a!==l||h!==d||c!==m){let t=1-o;const e=a*l+h*d+c*m+u*p,r=e>=0?1:-1,i=1-e*e;if(i>Number.EPSILON){const s=Math.sqrt(i),n=Math.atan2(s,e*r);t=Math.sin(t*n)/s,o=Math.sin(o*n)/s}const s=o*r;if(a=a*t+l*s,h=h*t+d*s,c=c*t+m*s,u=u*t+p*s,t===1-o){const t=1/Math.sqrt(a*a+h*h+c*c+u*u);a*=t,h*=t,c*=t,u*=t}}t[e]=a,t[e+1]=h,t[e+2]=c,t[e+3]=u}static multiplyQuaternionsFlat(t,e,r,i,s,n){const o=r[i],a=r[i+1],h=r[i+2],c=r[i+3],u=s[n],l=s[n+1],d=s[n+2],m=s[n+3];return t[e]=o*m+c*u+a*d-h*l,t[e+1]=a*m+c*l+h*u-o*d,t[e+2]=h*m+c*d+o*l-a*u,t[e+3]=c*m-o*u-a*l-h*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const r=t._x,i=t._y,s=t._z,n=t._order,o=Math.cos,a=Math.sin,h=o(r/2),c=o(i/2),u=o(s/2),l=a(r/2),d=a(i/2),m=a(s/2);switch(n){case"XYZ":this._x=l*c*u+h*d*m,this._y=h*d*u-l*c*m,this._z=h*c*m+l*d*u,this._w=h*c*u-l*d*m;break;case"YXZ":this._x=l*c*u+h*d*m,this._y=h*d*u-l*c*m,this._z=h*c*m-l*d*u,this._w=h*c*u+l*d*m;break;case"ZXY":this._x=l*c*u-h*d*m,this._y=h*d*u+l*c*m,this._z=h*c*m+l*d*u,this._w=h*c*u-l*d*m;break;case"ZYX":this._x=l*c*u-h*d*m,this._y=h*d*u+l*c*m,this._z=h*c*m-l*d*u,this._w=h*c*u+l*d*m;break;case"YZX":this._x=l*c*u+h*d*m,this._y=h*d*u+l*c*m,this._z=h*c*m-l*d*u,this._w=h*c*u-l*d*m;break;case"XZY":this._x=l*c*u-h*d*m,this._y=h*d*u-l*c*m,this._z=h*c*m+l*d*u,this._w=h*c*u+l*d*m;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+n)}return!1!==e&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],i=e[4],s=e[8],n=e[1],o=e[5],a=e[9],h=e[2],c=e[6],u=e[10],l=r+o+u;if(l>0){const t=.5/Math.sqrt(l+1);this._w=.25/t,this._x=(c-a)*t,this._y=(s-h)*t,this._z=(n-i)*t}else if(r>o&&r>u){const t=2*Math.sqrt(1+r-o-u);this._w=(c-a)/t,this._x=.25*t,this._y=(i+n)/t,this._z=(s+h)/t}else if(o>u){const t=2*Math.sqrt(1+o-r-u);this._w=(s-h)/t,this._x=(i+n)/t,this._y=.25*t,this._z=(a+c)/t}else{const t=2*Math.sqrt(1+u-r-o);this._w=(n-i)/t,this._x=(s+h)/t,this._y=(a+c)/t,this._z=.25*t}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<1e-6?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(y.clamp(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(0===r)return this;const i=Math.min(1,e/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,i=t._y,s=t._z,n=t._w,o=e._x,a=e._y,h=e._z,c=e._w;return this._x=r*c+n*o+i*h-s*a,this._y=i*c+n*a+s*o-r*h,this._z=s*c+n*h+r*a-i*o,this._w=n*c-r*o-i*a-s*h,this._onChangeCallback(),this}slerp(t,e){if(0===e)return this;if(1===e)return this.copy(t);const r=this._x,i=this._y,s=this._z,n=this._w;let o=n*t._w+r*t._x+i*t._y+s*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=n,this._x=r,this._y=i,this._z=s,this;const a=1-o*o;if(a<=Number.EPSILON){const t=1-e;return this._w=t*n+e*this._w,this._x=t*r+e*this._x,this._y=t*i+e*this._y,this._z=t*s+e*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(a),c=Math.atan2(h,o),u=Math.sin((1-e)*c)/h,l=Math.sin(e*c)/h;return this._w=n*u+this._w*l,this._x=r*u+this._x*l,this._y=i*u+this._y*l,this._z=s*u+this._z*l,this._onChangeCallback(),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}class A{constructor(t=0,e=0,r=0){Object.defineProperty(this,"isVector3",{value:!0}),this.x=t,this.y=e,this.z=r}set(t,e,r){return void 0===r&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(k.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(k.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[3]*r+s[6]*i,this.y=s[1]*e+s[4]*r+s[7]*i,this.z=s[2]*e+s[5]*r+s[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,s=t.elements,n=1/(s[3]*e+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*e+s[4]*r+s[8]*i+s[12])*n,this.y=(s[1]*e+s[5]*r+s[9]*i+s[13])*n,this.z=(s[2]*e+s[6]*r+s[10]*i+s[14])*n,this}applyQuaternion(t){const e=this.x,r=this.y,i=this.z,s=t.x,n=t.y,o=t.z,a=t.w,h=a*e+n*i-o*r,c=a*r+o*e-s*i,u=a*i+s*r-n*e,l=-s*e-n*r-o*i;return this.x=h*a+l*-s+c*-o-u*-n,this.y=c*a+l*-n+u*-s-h*-o,this.z=u*a+l*-o+h*-n-c*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[4]*r+s[8]*i,this.y=s[1]*e+s[5]*r+s[9]*i,this.z=s[2]*e+s[6]*r+s[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,i=t.y,s=t.z,n=e.x,o=e.y,a=e.z;return this.x=i*a-s*o,this.y=s*n-r*a,this.z=r*o-i*n,this}projectOnVector(t){const e=t.lengthSq();if(0===e)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return S.copy(this).projectOnVector(t),this.sub(S)}reflect(t){return this.sub(S.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===e)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(y.clamp(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return e*e+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const i=Math.sin(e)*t;return this.x=i*Math.sin(r),this.y=Math.cos(e)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,4*e)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,3*e)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e,r){return void 0!==r&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}const S=new A,k=new _;class E{constructor(t,e,r,i,s,n=0){this.a=t,this.b=e,this.c=r,this.normal=i&&i.isVector3?i:new A,this.vertexNormals=Array.isArray(i)?i:[],this.color=s&&s.isColor?s:new z,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=n}clone(){return(new this.constructor).copy(this)}copy(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let e=0,r=t.vertexNormals.length;e<r;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(let e=0,r=t.vertexColors.length;e<r;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}}class N{constructor(){Object.defineProperty(this,"isMatrix3",{value:!0}),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,e,r,i,s,n,o,a,h){const c=this.elements;return c[0]=t,c[1]=i,c[2]=o,c[3]=e,c[4]=s,c[5]=a,c[6]=r,c[7]=n,c[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}clone(){return(new this.constructor).fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,s=this.elements,n=r[0],o=r[3],a=r[6],h=r[1],c=r[4],u=r[7],l=r[2],d=r[5],m=r[8],p=i[0],f=i[3],y=i[6],x=i[1],g=i[4],b=i[7],v=i[2],w=i[5],M=i[8];return s[0]=n*p+o*x+a*v,s[3]=n*f+o*g+a*w,s[6]=n*y+o*b+a*M,s[1]=h*p+c*x+u*v,s[4]=h*f+c*g+u*w,s[7]=h*y+c*b+u*M,s[2]=l*p+d*x+m*v,s[5]=l*f+d*g+m*w,s[8]=l*y+d*b+m*M,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],h=t[7],c=t[8];return e*n*c-e*o*h-r*s*c+r*o*a+i*s*h-i*n*a}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],h=t[7],c=t[8],u=c*n-o*h,l=o*a-c*s,d=h*s-n*a,m=e*u+r*l+i*d;if(0===m)return this.set(0,0,0,0,0,0,0,0,0);const p=1/m;return t[0]=u*p,t[1]=(i*h-c*r)*p,t[2]=(o*r-i*n)*p,t[3]=l*p,t[4]=(c*e-i*a)*p,t[5]=(i*s-o*e)*p,t[6]=d*p,t[7]=(r*a-h*e)*p,t[8]=(n*e-r*s)*p,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).copy(this).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,i,s,n,o){const a=Math.cos(s),h=Math.sin(s);return this.set(r*a,r*h,-r*(a*n+h*o)+n+t,-i*h,i*a,-i*(-h*n+a*o)+o+e,0,0,1),this}scale(t,e){const r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=e,r[4]*=e,r[7]*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),i=this.elements,s=i[0],n=i[3],o=i[6],a=i[1],h=i[4],c=i[7];return i[0]=e*s+r*a,i[3]=e*n+r*h,i[6]=e*o+r*c,i[1]=-r*s+e*a,i[4]=-r*n+e*h,i[7]=-r*o+e*c,this}translate(t,e){const r=this.elements;return r[0]+=t*r[2],r[3]+=t*r[5],r[6]+=t*r[8],r[1]+=e*r[2],r[4]+=e*r[5],r[7]+=e*r[8],this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<9;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}}class B{constructor(t,e){Object.defineProperty(this,"isBox3",{value:!0}),this.min=void 0!==t?t:new A(1/0,1/0,1/0),this.max=void 0!==e?e:new A(-1/0,-1/0,-1/0)}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,r=1/0,i=1/0,s=-1/0,n=-1/0,o=-1/0;for(let a=0,h=t.length;a<h;a+=3){const h=t[a],c=t[a+1],u=t[a+2];h<e&&(e=h),c<r&&(r=c),u<i&&(i=u),h>s&&(s=h),c>n&&(n=c),u>o&&(o=u)}return this.min.set(e,r,i),this.max.set(s,n,o),this}setFromBufferAttribute(t){let e=1/0,r=1/0,i=1/0,s=-1/0,n=-1/0,o=-1/0;for(let a=0,h=t.count;a<h;a++){const h=t.getX(a),c=t.getY(a),u=t.getZ(a);h<e&&(e=h),c<r&&(r=c),u<i&&(i=u),h>s&&(s=h),c>n&&(n=c),u>o&&(o=u)}return this.min.set(e,r,i),this.max.set(s,n,o),this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=O.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t){return this.makeEmpty(),this.expandByObject(t)}clone(){return(new this.constructor).copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new A),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new A),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t){t.updateWorldMatrix(!1,!1);const e=t.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),T.copy(e.boundingBox),T.applyMatrix4(t.matrixWorld),this.union(T));const r=t.children;for(let t=0,e=r.length;t<e;t++)this.expandByObject(r[t]);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new A),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,O),O.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(D),I.subVectors(this.max,D),V.subVectors(t.a,D),R.subVectors(t.b,D),F.subVectors(t.c,D),j.subVectors(R,V),P.subVectors(F,R),q.subVectors(V,F);let e=[0,-j.z,j.y,0,-P.z,P.y,0,-q.z,q.y,j.z,0,-j.x,P.z,0,-P.x,q.z,0,-q.x,-j.y,j.x,0,-P.y,P.x,0,-q.y,q.x,0];return!!U(e,V,R,F,I)&&(!!U(e=[1,0,0,0,1,0,0,0,1],V,R,F,I)&&(L.crossVectors(j,P),U(e=[L.x,L.y,L.z],V,R,F,I)))}clampPoint(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new A),e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return O.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(O).length(),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(C[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),C[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),C[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),C[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),C[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),C[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),C[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),C[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(C),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}function U(t,e,r,i,s){for(let n=0,o=t.length-3;n<=o;n+=3){G.fromArray(t,n);const o=s.x*Math.abs(G.x)+s.y*Math.abs(G.y)+s.z*Math.abs(G.z),a=e.dot(G),h=r.dot(G),c=i.dot(G);if(Math.max(-Math.max(a,h,c),Math.min(a,h,c))>o)return!1}return!0}const C=[new A,new A,new A,new A,new A,new A,new A,new A],O=new A,T=new B,V=new A,R=new A,F=new A,j=new A,P=new A,q=new A,D=new A,I=new A,L=new A,G=new A,X=new B;class H{constructor(t,e){this.center=void 0!==t?t:new A,this.radius=void 0!==e?e:-1}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const r=this.center;void 0!==e?r.copy(e):X.setFromPoints(t).getCenter(r);let i=0;for(let e=0,s=t.length;e<s;e++)i=Math.max(i,r.distanceToSquared(t[e]));return this.radius=Math.sqrt(i),this}clone(){return(new this.constructor).copy(this)}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const r=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new A),e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new B),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}}class W{constructor(){Object.defineProperty(this,"isMatrix4",{value:!0}),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,e,r,i,s,n,o,a,h,c,u,l,d,m,p,f){const y=this.elements;return y[0]=t,y[4]=e,y[8]=r,y[12]=i,y[1]=s,y[5]=n,y[9]=o,y[13]=a,y[2]=h,y[6]=c,y[10]=u,y[14]=l,y[3]=d,y[7]=m,y[11]=p,y[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new W).fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}extractBasis(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,r=t.elements,i=1/Y.setFromMatrixColumn(t,0).length(),s=1/Y.setFromMatrixColumn(t,1).length(),n=1/Y.setFromMatrixColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*s,e[5]=r[5]*s,e[6]=r[6]*s,e[7]=0,e[8]=r[8]*n,e[9]=r[9]*n,e[10]=r[10]*n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const e=this.elements,r=t.x,i=t.y,s=t.z,n=Math.cos(r),o=Math.sin(r),a=Math.cos(i),h=Math.sin(i),c=Math.cos(s),u=Math.sin(s);if("XYZ"===t.order){const t=n*c,r=n*u,i=o*c,s=o*u;e[0]=a*c,e[4]=-a*u,e[8]=h,e[1]=r+i*h,e[5]=t-s*h,e[9]=-o*a,e[2]=s-t*h,e[6]=i+r*h,e[10]=n*a}else if("YXZ"===t.order){const t=a*c,r=a*u,i=h*c,s=h*u;e[0]=t+s*o,e[4]=i*o-r,e[8]=n*h,e[1]=n*u,e[5]=n*c,e[9]=-o,e[2]=r*o-i,e[6]=s+t*o,e[10]=n*a}else if("ZXY"===t.order){const t=a*c,r=a*u,i=h*c,s=h*u;e[0]=t-s*o,e[4]=-n*u,e[8]=i+r*o,e[1]=r+i*o,e[5]=n*c,e[9]=s-t*o,e[2]=-n*h,e[6]=o,e[10]=n*a}else if("ZYX"===t.order){const t=n*c,r=n*u,i=o*c,s=o*u;e[0]=a*c,e[4]=i*h-r,e[8]=t*h+s,e[1]=a*u,e[5]=s*h+t,e[9]=r*h-i,e[2]=-h,e[6]=o*a,e[10]=n*a}else if("YZX"===t.order){const t=n*a,r=n*h,i=o*a,s=o*h;e[0]=a*c,e[4]=s-t*u,e[8]=i*u+r,e[1]=u,e[5]=n*c,e[9]=-o*c,e[2]=-h*c,e[6]=r*u+i,e[10]=t-s*u}else if("XZY"===t.order){const t=n*a,r=n*h,i=o*a,s=o*h;e[0]=a*c,e[4]=-u,e[8]=h*c,e[1]=t*u+s,e[5]=n*c,e[9]=r*u-i,e[2]=i*u-r,e[6]=o*c,e[10]=s*u+t}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Q,t,J)}lookAt(t,e,r){const i=this.elements;return tt.subVectors(t,e),0===tt.lengthSq()&&(tt.z=1),tt.normalize(),$.crossVectors(r,tt),0===$.lengthSq()&&(1===Math.abs(r.z)?tt.x+=1e-4:tt.z+=1e-4,tt.normalize(),$.crossVectors(r,tt)),$.normalize(),K.crossVectors(tt,$),i[0]=$.x,i[4]=K.x,i[8]=tt.x,i[1]=$.y,i[5]=K.y,i[9]=tt.y,i[2]=$.z,i[6]=K.z,i[10]=tt.z,this}multiply(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,s=this.elements,n=r[0],o=r[4],a=r[8],h=r[12],c=r[1],u=r[5],l=r[9],d=r[13],m=r[2],p=r[6],f=r[10],y=r[14],x=r[3],g=r[7],b=r[11],v=r[15],w=i[0],M=i[4],z=i[8],_=i[12],A=i[1],S=i[5],k=i[9],E=i[13],N=i[2],B=i[6],U=i[10],C=i[14],O=i[3],T=i[7],V=i[11],R=i[15];return s[0]=n*w+o*A+a*N+h*O,s[4]=n*M+o*S+a*B+h*T,s[8]=n*z+o*k+a*U+h*V,s[12]=n*_+o*E+a*C+h*R,s[1]=c*w+u*A+l*N+d*O,s[5]=c*M+u*S+l*B+d*T,s[9]=c*z+u*k+l*U+d*V,s[13]=c*_+u*E+l*C+d*R,s[2]=m*w+p*A+f*N+y*O,s[6]=m*M+p*S+f*B+y*T,s[10]=m*z+p*k+f*U+y*V,s[14]=m*_+p*E+f*C+y*R,s[3]=x*w+g*A+b*N+v*O,s[7]=x*M+g*S+b*B+v*T,s[11]=x*z+g*k+b*U+v*V,s[15]=x*_+g*E+b*C+v*R,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],i=t[8],s=t[12],n=t[1],o=t[5],a=t[9],h=t[13],c=t[2],u=t[6],l=t[10],d=t[14];return t[3]*(+s*a*u-i*h*u-s*o*l+r*h*l+i*o*d-r*a*d)+t[7]*(+e*a*d-e*h*l+s*n*l-i*n*d+i*h*c-s*a*c)+t[11]*(+e*h*u-e*o*d-s*n*u+r*n*d+s*o*c-r*h*c)+t[15]*(-i*o*c-e*a*u+e*o*l+i*n*u-r*n*l+r*a*c)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],n=t[4],o=t[5],a=t[6],h=t[7],c=t[8],u=t[9],l=t[10],d=t[11],m=t[12],p=t[13],f=t[14],y=t[15],x=u*f*h-p*l*h+p*a*d-o*f*d-u*a*y+o*l*y,g=m*l*h-c*f*h-m*a*d+n*f*d+c*a*y-n*l*y,b=c*p*h-m*u*h+m*o*d-n*p*d-c*o*y+n*u*y,v=m*u*a-c*p*a-m*o*l+n*p*l+c*o*f-n*u*f,w=e*x+r*g+i*b+s*v;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/w;return t[0]=x*M,t[1]=(p*l*s-u*f*s-p*i*d+r*f*d+u*i*y-r*l*y)*M,t[2]=(o*f*s-p*a*s+p*i*h-r*f*h-o*i*y+r*a*y)*M,t[3]=(u*a*s-o*l*s-u*i*h+r*l*h+o*i*d-r*a*d)*M,t[4]=g*M,t[5]=(c*f*s-m*l*s+m*i*d-e*f*d-c*i*y+e*l*y)*M,t[6]=(m*a*s-n*f*s-m*i*h+e*f*h+n*i*y-e*a*y)*M,t[7]=(n*l*s-c*a*s+c*i*h-e*l*h-n*i*d+e*a*d)*M,t[8]=b*M,t[9]=(m*u*s-c*p*s-m*r*d+e*p*d+c*r*y-e*u*y)*M,t[10]=(n*p*s-m*o*s+m*r*h-e*p*h-n*r*y+e*o*y)*M,t[11]=(c*o*s-n*u*s-c*r*h+e*u*h+n*r*d-e*o*d)*M,t[12]=v*M,t[13]=(c*p*i-m*u*i+m*r*l-e*p*l-c*r*f+e*u*f)*M,t[14]=(m*o*i-n*p*i-m*r*a+e*p*a+n*r*f-e*o*f)*M,t[15]=(n*u*i-c*o*i+c*r*a-e*u*a-n*r*l+e*o*l)*M,this}scale(t){const e=this.elements,r=t.x,i=t.y,s=t.z;return e[0]*=r,e[4]*=i,e[8]*=s,e[1]*=r,e[5]*=i,e[9]*=s,e[2]*=r,e[6]*=i,e[10]*=s,e[3]*=r,e[7]*=i,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))}makeTranslation(t,e,r){return this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),i=Math.sin(e),s=1-r,n=t.x,o=t.y,a=t.z,h=s*n,c=s*o;return this.set(h*n+r,h*o-i*a,h*a+i*o,0,h*o+i*a,c*o+r,c*a-i*n,0,h*a-i*o,c*a+i*n,s*a*a+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r){return this.set(1,e,r,0,t,1,r,0,t,e,1,0,0,0,0,1),this}compose(t,e,r){const i=this.elements,s=e._x,n=e._y,o=e._z,a=e._w,h=s+s,c=n+n,u=o+o,l=s*h,d=s*c,m=s*u,p=n*c,f=n*u,y=o*u,x=a*h,g=a*c,b=a*u,v=r.x,w=r.y,M=r.z;return i[0]=(1-(p+y))*v,i[1]=(d+b)*v,i[2]=(m-g)*v,i[3]=0,i[4]=(d-b)*w,i[5]=(1-(l+y))*w,i[6]=(f+x)*w,i[7]=0,i[8]=(m+g)*M,i[9]=(f-x)*M,i[10]=(1-(l+p))*M,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,r){const i=this.elements;let s=Y.set(i[0],i[1],i[2]).length();const n=Y.set(i[4],i[5],i[6]).length(),o=Y.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],Z.copy(this);const a=1/s,h=1/n,c=1/o;return Z.elements[0]*=a,Z.elements[1]*=a,Z.elements[2]*=a,Z.elements[4]*=h,Z.elements[5]*=h,Z.elements[6]*=h,Z.elements[8]*=c,Z.elements[9]*=c,Z.elements[10]*=c,e.setFromRotationMatrix(Z),r.x=s,r.y=n,r.z=o,this}makePerspective(t,e,r,i,s,n){void 0===n&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const o=this.elements,a=2*s/(e-t),h=2*s/(r-i),c=(e+t)/(e-t),u=(r+i)/(r-i),l=-(n+s)/(n-s),d=-2*n*s/(n-s);return o[0]=a,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=h,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=l,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(t,e,r,i,s,n){const o=this.elements,a=1/(e-t),h=1/(r-i),c=1/(n-s),u=(e+t)*a,l=(r+i)*h,d=(n+s)*c;return o[0]=2*a,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*h,o[9]=0,o[13]=-l,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let t=0;t<16;t++)if(e[t]!==r[t])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const Y=new A,Z=new W,Q=new A(0,0,0),J=new A(1,1,1),$=new A,K=new A,tt=new A;class et{constructor(t=0,e=0){Object.defineProperty(this,"isVector2",{value:!0}),this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6],this.y=i[1]*e+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e,r){return void 0!==r&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),i=Math.sin(e),s=this.x-t.x,n=this.y-t.y;return this.x=s*r-n*i+t.x,this.y=s*i+n*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}class rt{constructor(t=0,e=0,r=0,i=rt.DefaultOrder){Object.defineProperty(this,"isEuler",{value:!0}),this._x=t,this._y=e,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._order=i||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e,r){const i=y.clamp,s=t.elements,n=s[0],o=s[4],a=s[8],h=s[1],c=s[5],u=s[9],l=s[2],d=s[6],m=s[10];switch(e=e||this._order){case"XYZ":this._y=Math.asin(i(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-u,m),this._z=Math.atan2(-o,n)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-i(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(a,m),this._z=Math.atan2(h,c)):(this._y=Math.atan2(-l,n),this._z=0);break;case"ZXY":this._x=Math.asin(i(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-l,m),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(h,n));break;case"ZYX":this._y=Math.asin(-i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(h,n)):(this._x=0,this._z=Math.atan2(-o,c));break;case"YZX":this._z=Math.asin(i(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-l,n)):(this._x=0,this._y=Math.atan2(a,m));break;case"XZY":this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(a,n)):(this._x=Math.atan2(-u,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,!1!==r&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return it.makeRotationFromQuaternion(t),this.setFromRotationMatrix(it,e,r)}setFromVector3(t,e){return this.set(t.x,t.y,t.z,e||this._order)}reorder(t){return st.setFromEuler(this),this.setFromQuaternion(st,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}toVector3(t){return t?t.set(this._x,this._y,this._z):new A(this._x,this._y,this._z)}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}}rt.DefaultOrder="XYZ",rt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];const it=new W,st=new _;class nt{constructor(){this.mask=1}set(t){this.mask=1<<t|0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return 0!=(this.mask&t.mask)}}let ot=0;const at=new A,ht=new _,ct=new W,ut=new A,lt=new A,dt=new A,mt=new _,pt=new A(1,0,0),ft=new A(0,1,0),yt=new A(0,0,1),xt={type:"added"},gt={type:"removed"};function bt(){Object.defineProperty(this,"id",{value:ot++}),this.uuid=y.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=bt.DefaultUp.clone();const t=new A,e=new rt,r=new _,i=new A(1,1,1);e._onChange(function(){r.setFromEuler(e,!1)}),r._onChange(function(){e.setFromQuaternion(r,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new W},normalMatrix:{value:new N}}),this.matrix=new W,this.matrixWorld=new W,this.matrixAutoUpdate=bt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new nt,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}bt.DefaultUp=new A(0,1,0),bt.DefaultMatrixAutoUpdate=!0,bt.prototype=Object.assign(Object.create(m.prototype),{constructor:bt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,e){return ht.setFromAxisAngle(t,e),this.quaternion.multiply(ht),this},rotateOnWorldAxis:function(t,e){return ht.setFromAxisAngle(t,e),this.quaternion.premultiply(ht),this},rotateX:function(t){return this.rotateOnAxis(pt,t)},rotateY:function(t){return this.rotateOnAxis(ft,t)},rotateZ:function(t){return this.rotateOnAxis(yt,t)},translateOnAxis:function(t,e){return at.copy(t).applyQuaternion(this.quaternion),this.position.add(at.multiplyScalar(e)),this},translateX:function(t){return this.translateOnAxis(pt,t)},translateY:function(t){return this.translateOnAxis(ft,t)},translateZ:function(t){return this.translateOnAxis(yt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(ct.copy(this.matrixWorld).invert())},lookAt:function(t,e,r){t.isVector3?ut.copy(t):ut.set(t,e,r);const i=this.parent;this.updateWorldMatrix(!0,!1),lt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ct.lookAt(lt,ut,this.up):ct.lookAt(ut,lt,this.up),this.quaternion.setFromRotationMatrix(ct),i&&(ct.extractRotation(i.matrixWorld),ht.setFromRotationMatrix(ct),this.quaternion.premultiply(ht.invert()))},add:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(xt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(t);return-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(gt)),this},clear:function(){for(let t=0;t<this.children.length;t++){const e=this.children[t];e.parent=null,e.dispatchEvent(gt)}return this.children.length=0,this},attach:function(t){return this.updateWorldMatrix(!0,!1),ct.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),ct.multiply(t.parent.matrixWorld)),t.applyMatrix4(ct),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(let r=0,i=this.children.length;r<i;r++){const i=this.children[r].getObjectByProperty(t,e);if(void 0!==i)return i}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new A),this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new _),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lt,t,dt),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new A),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(lt,mt,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new A),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverseVisible(t)},traverseAncestors:function(t){const e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].updateMatrixWorld(t)},updateWorldMatrix:function(t,e){const r=this.parent;if(!0===t&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===e){const t=this.children;for(let e=0,r=t.length;e<r;e++)t[e].updateWorldMatrix(!1,!0)}},toJSON:function(t){const e=void 0===t||"string"==typeof t,r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const i={};function s(e,r){return void 0===e[r.uuid]&&(e[r.uuid]=r.toJSON(t)),r.uuid}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),!0===this.castShadow&&(i.castShadow=!0),!0===this.receiveShadow&&(i.receiveShadow=!0),!1===this.visible&&(i.visible=!1),!1===this.frustumCulled&&(i.frustumCulled=!1),0!==this.renderOrder&&(i.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){i.geometry=s(t.geometries,this.geometry);const e=this.geometry.parameters;if(void 0!==e&&void 0!==e.shapes){const r=e.shapes;if(Array.isArray(r))for(let e=0,i=r.length;e<i;e++){const i=r[e];s(t.shapes,i)}else s(t.shapes,r)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const e=[];for(let r=0,i=this.material.length;r<i;r++)e.push(s(t.materials,this.material[r]));i.material=e}else i.material=s(t.materials,this.material);if(this.children.length>0){i.children=[];for(let e=0;e<this.children.length;e++)i.children.push(this.children[e].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let e=0;e<this.animations.length;e++){const r=this.animations[e];i.animations.push(s(t.animations,r))}}if(e){const e=n(t.geometries),i=n(t.materials),s=n(t.textures),o=n(t.images),a=n(t.shapes),h=n(t.skeletons),c=n(t.animations);e.length>0&&(r.geometries=e),i.length>0&&(r.materials=i),s.length>0&&(r.textures=s),o.length>0&&(r.images=o),a.length>0&&(r.shapes=a),h.length>0&&(r.skeletons=h),c.length>0&&(r.animations=c)}return r.object=i,r;function n(t){const e=[];for(const r in t){const i=t[r];delete i.metadata,e.push(i)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(let e=0;e<t.children.length;e++){const r=t.children[e];this.add(r.clone())}return this}});let vt=0;const wt=new W,Mt=new bt,zt=new A;function _t(){Object.defineProperty(this,"id",{value:vt+=2}),this.uuid=y.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}_t.prototype=Object.assign(Object.create(m.prototype),{constructor:_t,isGeometry:!0,applyMatrix4:function(t){const e=(new N).getNormalMatrix(t);for(let e=0,r=this.vertices.length;e<r;e++){this.vertices[e].applyMatrix4(t)}for(let t=0,r=this.faces.length;t<r;t++){const r=this.faces[t];r.normal.applyMatrix3(e).normalize();for(let t=0,i=r.vertexNormals.length;t<i;t++)r.vertexNormals[t].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return wt.makeRotationX(t),this.applyMatrix4(wt),this},rotateY:function(t){return wt.makeRotationY(t),this.applyMatrix4(wt),this},rotateZ:function(t){return wt.makeRotationZ(t),this.applyMatrix4(wt),this},translate:function(t,e,r){return wt.makeTranslation(t,e,r),this.applyMatrix4(wt),this},scale:function(t,e,r){return wt.makeScale(t,e,r),this.applyMatrix4(wt),this},lookAt:function(t){return Mt.lookAt(t),Mt.updateMatrix(),this.applyMatrix4(Mt.matrix),this},fromBufferGeometry:function(t){const e=this,r=null!==t.index?t.index:void 0,i=t.attributes;if(void 0===i.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const s=i.position,n=i.normal,o=i.color,a=i.uv,h=i.uv2;void 0!==h&&(this.faceVertexUvs[1]=[]);for(let t=0;t<s.count;t++)e.vertices.push((new A).fromBufferAttribute(s,t)),void 0!==o&&e.colors.push((new z).fromBufferAttribute(o,t));function c(t,r,i,s){const c=void 0===o?[]:[e.colors[t].clone(),e.colors[r].clone(),e.colors[i].clone()],u=void 0===n?[]:[(new A).fromBufferAttribute(n,t),(new A).fromBufferAttribute(n,r),(new A).fromBufferAttribute(n,i)],l=new E(t,r,i,u,c,s);e.faces.push(l),void 0!==a&&e.faceVertexUvs[0].push([(new et).fromBufferAttribute(a,t),(new et).fromBufferAttribute(a,r),(new et).fromBufferAttribute(a,i)]),void 0!==h&&e.faceVertexUvs[1].push([(new et).fromBufferAttribute(h,t),(new et).fromBufferAttribute(h,r),(new et).fromBufferAttribute(h,i)])}const u=t.groups;if(u.length>0)for(let t=0;t<u.length;t++){const e=u[t],i=e.start;for(let t=i,s=i+e.count;t<s;t+=3)void 0!==r?c(r.getX(t),r.getX(t+1),r.getX(t+2),e.materialIndex):c(t,t+1,t+2,e.materialIndex)}else if(void 0!==r)for(let t=0;t<r.count;t+=3)c(r.getX(t),r.getX(t+1),r.getX(t+2));else for(let t=0;t<s.count;t+=3)c(t,t+1,t+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(zt).negate(),this.translate(zt.x,zt.y,zt.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,e=this.boundingSphere.radius,r=0===e?1:1/e,i=new W;return i.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){const t=new A,e=new A;for(let r=0,i=this.faces.length;r<i;r++){const i=this.faces[r],s=this.vertices[i.a],n=this.vertices[i.b],o=this.vertices[i.c];t.subVectors(o,n),e.subVectors(s,n),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t=!0){const e=new Array(this.vertices.length);for(let t=0,r=this.vertices.length;t<r;t++)e[t]=new A;if(t){const t=new A,r=new A;for(let i=0,s=this.faces.length;i<s;i++){const s=this.faces[i],n=this.vertices[s.a],o=this.vertices[s.b],a=this.vertices[s.c];t.subVectors(a,o),r.subVectors(n,o),t.cross(r),e[s.a].add(t),e[s.b].add(t),e[s.c].add(t)}}else{this.computeFaceNormals();for(let t=0,r=this.faces.length;t<r;t++){const r=this.faces[t];e[r.a].add(r.normal),e[r.b].add(r.normal),e[r.c].add(r.normal)}}for(let t=0,r=this.vertices.length;t<r;t++)e[t].normalize();for(let t=0,r=this.faces.length;t<r;t++){const r=this.faces[t],i=r.vertexNormals;3===i.length?(i[0].copy(e[r.a]),i[1].copy(e[r.b]),i[2].copy(e[r.c])):(i[0]=e[r.a].clone(),i[1]=e[r.b].clone(),i[2]=e[r.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t],r=e.vertexNormals;3===r.length?(r[0].copy(e.normal),r[1].copy(e.normal),r[2].copy(e.normal)):(r[0]=e.normal.clone(),r[1]=e.normal.clone(),r[2]=e.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t];e.__originalFaceNormal?e.__originalFaceNormal.copy(e.normal):e.__originalFaceNormal=e.normal.clone(),e.__originalVertexNormals||(e.__originalVertexNormals=[]);for(let t=0,r=e.vertexNormals.length;t<r;t++)e.__originalVertexNormals[t]?e.__originalVertexNormals[t].copy(e.vertexNormals[t]):e.__originalVertexNormals[t]=e.vertexNormals[t].clone()}const t=new _t;t.faces=this.faces;for(let e=0,r=this.morphTargets.length;e<r;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];const t=this.morphNormals[e].faceNormals,r=this.morphNormals[e].vertexNormals;for(let e=0,i=this.faces.length;e<i;e++){const e=new A,i={a:new A,b:new A,c:new A};t.push(e),r.push(i)}}const r=this.morphNormals[e];t.vertices=this.morphTargets[e].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t],i=r.faceNormals[t],s=r.vertexNormals[t];i.copy(e.normal),s.a.copy(e.vertexNormals[0]),s.b.copy(e.vertexNormals[1]),s.c.copy(e.vertexNormals[2])}}for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t];e.normal=e.__originalFaceNormal,e.vertexNormals=e.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new B),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new H),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,r=0){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let i;const s=this.vertices.length,n=this.vertices,o=t.vertices,a=this.faces,h=t.faces,c=this.colors,u=t.colors;void 0!==e&&(i=(new N).getNormalMatrix(e));for(let t=0,r=o.length;t<r;t++){const r=o[t].clone();void 0!==e&&r.applyMatrix4(e),n.push(r)}for(let t=0,e=u.length;t<e;t++)c.push(u[t].clone());for(let t=0,e=h.length;t<e;t++){const e=h[t];let n,o;const c=e.vertexNormals,u=e.vertexColors,l=new E(e.a+s,e.b+s,e.c+s);l.normal.copy(e.normal),void 0!==i&&l.normal.applyMatrix3(i).normalize();for(let t=0,e=c.length;t<e;t++)n=c[t].clone(),void 0!==i&&n.applyMatrix3(i).normalize(),l.vertexNormals.push(n);l.color.copy(e.color);for(let t=0,e=u.length;t<e;t++)o=u[t],l.vertexColors.push(o.clone());l.materialIndex=e.materialIndex+r,a.push(l)}for(let e=0,r=t.faceVertexUvs.length;e<r;e++){const r=t.faceVertexUvs[e];void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]);for(let t=0,i=r.length;t<i;t++){const i=r[t],s=[];for(let t=0,e=i.length;t<e;t++)s.push(i[t].clone());this.faceVertexUvs[e].push(s)}}},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(t=4){const e={},r=[],i=[],s=Math.pow(10,t);for(let t=0,n=this.vertices.length;t<n;t++){const n=this.vertices[t],o=Math.round(n.x*s)+"_"+Math.round(n.y*s)+"_"+Math.round(n.z*s);void 0===e[o]?(e[o]=t,r.push(this.vertices[t]),i[t]=r.length-1):i[t]=i[e[o]]}const n=[];for(let t=0,e=this.faces.length;t<e;t++){const e=this.faces[t];e.a=i[e.a],e.b=i[e.b],e.c=i[e.c];const r=[e.a,e.b,e.c];for(let e=0;e<3;e++)if(r[e]===r[(e+1)%3]){n.push(t);break}}for(let t=n.length-1;t>=0;t--){const e=n[t];this.faces.splice(e,1);for(let t=0,r=this.faceVertexUvs.length;t<r;t++)this.faceVertexUvs[t].splice(e,1)}const o=this.vertices.length-r.length;return this.vertices=r,o},setFromPoints:function(t){this.vertices=[];for(let e=0,r=t.length;e<r;e++){const r=t[e];this.vertices.push(new A(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,e=t.length;for(let r=0;r<e;r++)t[r]._id=r;t.sort(function(t,e){return t.materialIndex-e.materialIndex});const r=this.faceVertexUvs[0],i=this.faceVertexUvs[1];let s,n;r&&r.length===e&&(s=[]),i&&i.length===e&&(n=[]);for(let o=0;o<e;o++){const e=t[o]._id;s&&s.push(r[e]),n&&n.push(i[e])}s&&(this.faceVertexUvs[0]=s),n&&(this.faceVertexUvs[1]=n)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){const e=this.parameters;for(const r in e)void 0!==e[r]&&(t[r]=e[r]);return t}const e=[];for(let t=0;t<this.vertices.length;t++){const r=this.vertices[t];e.push(r.x,r.y,r.z)}const r=[],i=[],s={},n=[],o={},a=[],h={};for(let t=0;t<this.faces.length;t++){const e=this.faces[t],i=!0,s=!1,n=void 0!==this.faceVertexUvs[0][t],o=e.normal.length()>0,a=e.vertexNormals.length>0,h=1!==e.color.r||1!==e.color.g||1!==e.color.b,m=e.vertexColors.length>0;let p=0;if(p=c(p,0,0),p=c(p,1,i),p=c(p,2,s),p=c(p,3,n),p=c(p,4,o),p=c(p,5,a),p=c(p,6,h),p=c(p,7,m),r.push(p),r.push(e.a,e.b,e.c),r.push(e.materialIndex),n){const e=this.faceVertexUvs[0][t];r.push(d(e[0]),d(e[1]),d(e[2]))}if(o&&r.push(u(e.normal)),a){const t=e.vertexNormals;r.push(u(t[0]),u(t[1]),u(t[2]))}if(h&&r.push(l(e.color)),m){const t=e.vertexColors;r.push(l(t[0]),l(t[1]),l(t[2]))}}function c(t,e,r){return r?t|1<<e:t&~(1<<e)}function u(t){const e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==s[e]?s[e]:(s[e]=i.length/3,i.push(t.x,t.y,t.z),s[e])}function l(t){const e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==o[e]?o[e]:(o[e]=n.length,n.push(t.getHex()),o[e])}function d(t){const e=t.x.toString()+t.y.toString();return void 0!==h[e]?h[e]:(h[e]=a.length/2,a.push(t.x,t.y),h[e])}return t.data={},t.data.vertices=e,t.data.normals=i,n.length>0&&(t.data.colors=n),a.length>0&&(t.data.uvs=[a]),t.data.faces=r,t},clone:function(){return(new _t).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const e=t.vertices;for(let t=0,r=e.length;t<r;t++)this.vertices.push(e[t].clone());const r=t.colors;for(let t=0,e=r.length;t<e;t++)this.colors.push(r[t].clone());const i=t.faces;for(let t=0,e=i.length;t<e;t++)this.faces.push(i[t].clone());for(let e=0,r=t.faceVertexUvs.length;e<r;e++){const r=t.faceVertexUvs[e];void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]);for(let t=0,i=r.length;t<i;t++){const i=r[t],s=[];for(let t=0,e=i.length;t<e;t++){const e=i[t];s.push(e.clone())}this.faceVertexUvs[e].push(s)}}const s=t.morphTargets;for(let t=0,e=s.length;t<e;t++){const e={};if(e.name=s[t].name,void 0!==s[t].vertices){e.vertices=[];for(let r=0,i=s[t].vertices.length;r<i;r++)e.vertices.push(s[t].vertices[r].clone())}if(void 0!==s[t].normals){e.normals=[];for(let r=0,i=s[t].normals.length;r<i;r++)e.normals.push(s[t].normals[r].clone())}this.morphTargets.push(e)}const n=t.morphNormals;for(let t=0,e=n.length;t<e;t++){const e={};if(void 0!==n[t].vertexNormals){e.vertexNormals=[];for(let r=0,i=n[t].vertexNormals.length;r<i;r++){const i=n[t].vertexNormals[r],s={};s.a=i.a.clone(),s.b=i.b.clone(),s.c=i.c.clone(),e.vertexNormals.push(s)}}if(void 0!==n[t].faceNormals){e.faceNormals=[];for(let r=0,i=n[t].faceNormals.length;r<i;r++)e.faceNormals.push(n[t].faceNormals[r].clone())}this.morphNormals.push(e)}const o=t.skinWeights;for(let t=0,e=o.length;t<e;t++)this.skinWeights.push(o[t].clone());const a=t.skinIndices;for(let t=0,e=a.length;t<e;t++)this.skinIndices.push(a[t].clone());const h=t.lineDistances;for(let t=0,e=h.length;t<e;t++)this.lineDistances.push(h[t]);const c=t.boundingBox;null!==c&&(this.boundingBox=c.clone());const u=t.boundingSphere;return null!==u&&(this.boundingSphere=u.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class At{constructor(t=0,e=0,r=0,i=1){Object.defineProperty(this,"isVector4",{value:!0}),this.x=t,this.y=e,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this}add(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,s=this.w,n=t.elements;return this.x=n[0]*e+n[4]*r+n[8]*i+n[12]*s,this.y=n[1]*e+n[5]*r+n[9]*i+n[13]*s,this.z=n[2]*e+n[6]*r+n[10]*i+n[14]*s,this.w=n[3]*e+n[7]*r+n[11]*i+n[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,i,s;const n=t.elements,o=n[0],a=n[4],h=n[8],c=n[1],u=n[5],l=n[9],d=n[2],m=n[6],p=n[10];if(Math.abs(a-c)<.01&&Math.abs(h-d)<.01&&Math.abs(l-m)<.01){if(Math.abs(a+c)<.1&&Math.abs(h+d)<.1&&Math.abs(l+m)<.1&&Math.abs(o+u+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const t=(o+1)/2,n=(u+1)/2,f=(p+1)/2,y=(a+c)/4,x=(h+d)/4,g=(l+m)/4;return t>n&&t>f?t<.01?(r=0,i=.707106781,s=.707106781):(i=y/(r=Math.sqrt(t)),s=x/r):n>f?n<.01?(r=.707106781,i=0,s=.707106781):(r=y/(i=Math.sqrt(n)),s=g/i):f<.01?(r=.707106781,i=.707106781,s=0):(r=x/(s=Math.sqrt(f)),i=g/s),this.set(r,i,s,e),this}let f=Math.sqrt((m-l)*(m-l)+(h-d)*(h-d)+(c-a)*(c-a));return Math.abs(f)<.001&&(f=1),this.x=(m-l)/f,this.y=(h-d)/f,this.z=(c-a)/f,this.w=Math.acos((o+u+p-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this.w=Math.max(t,Math.min(e,this.w)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e,r){return void 0!==r&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}const St=35044,kt=new A,Et=new et;function Nt(t,e,r){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===r,this.usage=St,this.updateRange={offset:0,count:-1},this.version=0}function Bt(t,e,r){Nt.call(this,new Int8Array(t),e,r)}function Ut(t,e,r){Nt.call(this,new Uint8Array(t),e,r)}function Ct(t,e,r){Nt.call(this,new Uint8ClampedArray(t),e,r)}function Ot(t,e,r){Nt.call(this,new Int16Array(t),e,r)}function Tt(t,e,r){Nt.call(this,new Uint16Array(t),e,r)}function Vt(t,e,r){Nt.call(this,new Int32Array(t),e,r)}function Rt(t,e,r){Nt.call(this,new Uint32Array(t),e,r)}function Ft(t,e,r){Nt.call(this,new Uint16Array(t),e,r)}function jt(t,e,r){Nt.call(this,new Float32Array(t),e,r)}function Pt(t,e,r){Nt.call(this,new Float64Array(t),e,r)}Object.defineProperty(Nt.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Nt.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,e,r){t*=this.itemSize,r*=e.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[t+i]=e.array[r+i];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const e=this.array;let r=0;for(let i=0,s=t.length;i<s;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),s=new z),e[r++]=s.r,e[r++]=s.g,e[r++]=s.b}return this},copyVector2sArray:function(t){const e=this.array;let r=0;for(let i=0,s=t.length;i<s;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),s=new et),e[r++]=s.x,e[r++]=s.y}return this},copyVector3sArray:function(t){const e=this.array;let r=0;for(let i=0,s=t.length;i<s;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),s=new A),e[r++]=s.x,e[r++]=s.y,e[r++]=s.z}return this},copyVector4sArray:function(t){const e=this.array;let r=0;for(let i=0,s=t.length;i<s;i++){let s=t[i];void 0===s&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),s=new At),e[r++]=s.x,e[r++]=s.y,e[r++]=s.z,e[r++]=s.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let e=0,r=this.count;e<r;e++)Et.fromBufferAttribute(this,e),Et.applyMatrix3(t),this.setXY(e,Et.x,Et.y);else if(3===this.itemSize)for(let e=0,r=this.count;e<r;e++)kt.fromBufferAttribute(this,e),kt.applyMatrix3(t),this.setXYZ(e,kt.x,kt.y,kt.z);return this},applyMatrix4:function(t){for(let e=0,r=this.count;e<r;e++)kt.x=this.getX(e),kt.y=this.getY(e),kt.z=this.getZ(e),kt.applyMatrix4(t),this.setXYZ(e,kt.x,kt.y,kt.z);return this},applyNormalMatrix:function(t){for(let e=0,r=this.count;e<r;e++)kt.x=this.getX(e),kt.y=this.getY(e),kt.z=this.getZ(e),kt.applyNormalMatrix(t),this.setXYZ(e,kt.x,kt.y,kt.z);return this},transformDirection:function(t){for(let e=0,r=this.count;e<r;e++)kt.x=this.getX(e),kt.y=this.getY(e),kt.z=this.getZ(e),kt.transformDirection(t),this.setXYZ(e,kt.x,kt.y,kt.z);return this},set:function(t,e=0){return this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this},setXYZ:function(t,e,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this},setXYZW:function(t,e,r,i,s){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=s,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Bt.prototype=Object.create(Nt.prototype),Bt.prototype.constructor=Bt,Ut.prototype=Object.create(Nt.prototype),Ut.prototype.constructor=Ut,Ct.prototype=Object.create(Nt.prototype),Ct.prototype.constructor=Ct,Ot.prototype=Object.create(Nt.prototype),Ot.prototype.constructor=Ot,Tt.prototype=Object.create(Nt.prototype),Tt.prototype.constructor=Tt,Vt.prototype=Object.create(Nt.prototype),Vt.prototype.constructor=Vt,Rt.prototype=Object.create(Nt.prototype),Rt.prototype.constructor=Rt,Ft.prototype=Object.create(Nt.prototype),Ft.prototype.constructor=Ft,Ft.prototype.isFloat16BufferAttribute=!0,jt.prototype=Object.create(Nt.prototype),jt.prototype.constructor=jt,Pt.prototype=Object.create(Nt.prototype),Pt.prototype.constructor=Pt;class qt{constructor(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}computeGroups(t){const e=[];let r,i,s=void 0;const n=t.faces;for(i=0;i<n.length;i++){const t=n[i];t.materialIndex!==s&&(s=t.materialIndex,void 0!==r&&(r.count=3*i-r.start,e.push(r)),r={start:3*i,materialIndex:s})}void 0!==r&&(r.count=3*i-r.start,e.push(r)),this.groups=e}fromGeometry(t){const e=t.faces,r=t.vertices,i=t.faceVertexUvs,s=i[0]&&i[0].length>0,n=i[1]&&i[1].length>0,o=t.morphTargets,a=o.length;let h;if(a>0){h=[];for(let t=0;t<a;t++)h[t]={name:o[t].name,data:[]};this.morphTargets.position=h}const c=t.morphNormals,u=c.length;let l;if(u>0){l=[];for(let t=0;t<u;t++)l[t]={name:c[t].name,data:[]};this.morphTargets.normal=l}const d=t.skinIndices,m=t.skinWeights,p=d.length===r.length,f=m.length===r.length;r.length>0&&0===e.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let t=0;t<e.length;t++){const y=e[t];this.vertices.push(r[y.a],r[y.b],r[y.c]);const x=y.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{const t=y.normal;this.normals.push(t,t,t)}const g=y.vertexColors;if(3===g.length)this.colors.push(g[0],g[1],g[2]);else{const t=y.color;this.colors.push(t,t,t)}if(!0===s){const e=i[0][t];void 0!==e?this.uvs.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",t),this.uvs.push(new et,new et,new et))}if(!0===n){const e=i[1][t];void 0!==e?this.uvs2.push(e[0],e[1],e[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",t),this.uvs2.push(new et,new et,new et))}for(let t=0;t<a;t++){const e=o[t].vertices;h[t].data.push(e[y.a],e[y.b],e[y.c])}for(let e=0;e<u;e++){const r=c[e].vertexNormals[t];l[e].data.push(r.a,r.b,r.c)}p&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),f&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}}Int8Array,Uint8Array,"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let Dt=1;const It=new W,Lt=new bt,Gt=new A,Xt=new B,Ht=new B,Wt=new A;function Yt(){Object.defineProperty(this,"id",{value:Dt+=2}),this.uuid=y.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Yt.prototype=Object.assign(Object.create(m.prototype),{constructor:Yt,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){return Array.isArray(t)?this.index=new(function(t){if(0===t.length)return-1/0;let e=t[0];for(let r=1,i=t.length;r<i;++r)t[r]>e&&(e=t[r]);return e}(t)>65535?Rt:Tt)(t,1):this.index=t,this},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,e){return this.attributes[t]=e,this},deleteAttribute:function(t){return delete this.attributes[t],this},hasAttribute:function(t){return void 0!==this.attributes[t]},addGroup:function(t,e,r=0){this.groups.push({start:t,count:e,materialIndex:r})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix4:function(t){const e=this.attributes.position;void 0!==e&&(e.applyMatrix4(t),e.needsUpdate=!0);const r=this.attributes.normal;if(void 0!==r){const e=(new N).getNormalMatrix(t);r.applyNormalMatrix(e),r.needsUpdate=!0}const i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(t),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return It.makeRotationX(t),this.applyMatrix4(It),this},rotateY:function(t){return It.makeRotationY(t),this.applyMatrix4(It),this},rotateZ:function(t){return It.makeRotationZ(t),this.applyMatrix4(It),this},translate:function(t,e,r){return It.makeTranslation(t,e,r),this.applyMatrix4(It),this},scale:function(t,e,r){return It.makeScale(t,e,r),this.applyMatrix4(It),this},lookAt:function(t){return Lt.lookAt(t),Lt.updateMatrix(),this.applyMatrix4(Lt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gt).negate(),this.translate(Gt.x,Gt.y,Gt.z),this},setFromObject:function(t){const e=t.geometry;if(t.isPoints||t.isLine){const t=new jt(3*e.vertices.length,3),r=new jt(3*e.colors.length,3);if(this.setAttribute("position",t.copyVector3sArray(e.vertices)),this.setAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){const t=new jt(e.lineDistances.length,1);this.setAttribute("lineDistance",t.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){const e=[];for(let r=0,i=t.length;r<i;r++){const i=t[r];e.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new jt(e,3)),this},updateFromObject:function(t){let e=t.geometry;if(t.isMesh){let t=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(t=void 0,e.elementsNeedUpdate=!1),void 0===t)return this.fromGeometry(e);t.verticesNeedUpdate=e.verticesNeedUpdate,t.normalsNeedUpdate=e.normalsNeedUpdate,t.colorsNeedUpdate=e.colorsNeedUpdate,t.uvsNeedUpdate=e.uvsNeedUpdate,t.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=t}if(!0===e.verticesNeedUpdate){const t=this.attributes.position;void 0!==t&&(t.copyVector3sArray(e.vertices),t.needsUpdate=!0),e.verticesNeedUpdate=!1}if(!0===e.normalsNeedUpdate){const t=this.attributes.normal;void 0!==t&&(t.copyVector3sArray(e.normals),t.needsUpdate=!0),e.normalsNeedUpdate=!1}if(!0===e.colorsNeedUpdate){const t=this.attributes.color;void 0!==t&&(t.copyColorsArray(e.colors),t.needsUpdate=!0),e.colorsNeedUpdate=!1}if(e.uvsNeedUpdate){const t=this.attributes.uv;void 0!==t&&(t.copyVector2sArray(e.uvs),t.needsUpdate=!0),e.uvsNeedUpdate=!1}if(e.lineDistancesNeedUpdate){const t=this.attributes.lineDistance;void 0!==t&&(t.copyArray(e.lineDistances),t.needsUpdate=!0),e.lineDistancesNeedUpdate=!1}return e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new qt).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const e=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Nt(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){const e=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Nt(e,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const e=new Float32Array(3*t.colors.length);this.setAttribute("color",new Nt(e,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const e=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Nt(e,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const e=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Nt(e,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const e in t.morphTargets){const r=[],i=t.morphTargets[e];for(let t=0,e=i.length;t<e;t++){const e=i[t],s=new jt(3*e.data.length,3);s.name=e.name,r.push(s.copyVector3sArray(e.data))}this.morphAttributes[e]=r}if(t.skinIndices.length>0){const e=new jt(4*t.skinIndices.length,4);this.setAttribute("skinIndex",e.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const e=new jt(4*t.skinWeights.length,4);this.setAttribute("skinWeight",e.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new B);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new A(-1/0,-1/0,-1/0),new A(1/0,1/0,1/0));if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const r=e[t];Xt.setFromBufferAttribute(r),this.morphTargetsRelative?(Wt.addVectors(this.boundingBox.min,Xt.min),this.boundingBox.expandByPoint(Wt),Wt.addVectors(this.boundingBox.max,Xt.max),this.boundingBox.expandByPoint(Wt)):(this.boundingBox.expandByPoint(Xt.min),this.boundingBox.expandByPoint(Xt.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new H);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new A,1/0);if(t){const r=this.boundingSphere.center;if(Xt.setFromBufferAttribute(t),e)for(let t=0,r=e.length;t<r;t++){const r=e[t];Ht.setFromBufferAttribute(r),this.morphTargetsRelative?(Wt.addVectors(Xt.min,Ht.min),Xt.expandByPoint(Wt),Wt.addVectors(Xt.max,Ht.max),Xt.expandByPoint(Wt)):(Xt.expandByPoint(Ht.min),Xt.expandByPoint(Ht.max))}Xt.getCenter(r);let i=0;for(let e=0,s=t.count;e<s;e++)Wt.fromBufferAttribute(t,e),i=Math.max(i,r.distanceToSquared(Wt));if(e)for(let s=0,n=e.length;s<n;s++){const n=e[s],o=this.morphTargetsRelative;for(let e=0,s=n.count;e<s;e++)Wt.fromBufferAttribute(n,e),o&&(Gt.fromBufferAttribute(t,e),Wt.add(Gt)),i=Math.max(i,r.distanceToSquared(Wt))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,e=this.getAttribute("position");if(void 0!==e){let r=this.getAttribute("normal");if(void 0===r)r=new Nt(new Float32Array(3*e.count),3),this.setAttribute("normal",r);else for(let t=0,e=r.count;t<e;t++)r.setXYZ(t,0,0,0);const i=new A,s=new A,n=new A,o=new A,a=new A,h=new A,c=new A,u=new A;if(t)for(let l=0,d=t.count;l<d;l+=3){const d=t.getX(l+0),m=t.getX(l+1),p=t.getX(l+2);i.fromBufferAttribute(e,d),s.fromBufferAttribute(e,m),n.fromBufferAttribute(e,p),c.subVectors(n,s),u.subVectors(i,s),c.cross(u),o.fromBufferAttribute(r,d),a.fromBufferAttribute(r,m),h.fromBufferAttribute(r,p),o.add(c),a.add(c),h.add(c),r.setXYZ(d,o.x,o.y,o.z),r.setXYZ(m,a.x,a.y,a.z),r.setXYZ(p,h.x,h.y,h.z)}else for(let t=0,o=e.count;t<o;t+=3)i.fromBufferAttribute(e,t+0),s.fromBufferAttribute(e,t+1),n.fromBufferAttribute(e,t+2),c.subVectors(n,s),u.subVectors(i,s),c.cross(u),r.setXYZ(t+0,c.x,c.y,c.z),r.setXYZ(t+1,c.x,c.y,c.z),r.setXYZ(t+2,c.x,c.y,c.z);this.normalizeNormals(),r.needsUpdate=!0}},merge:function(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const r=this.attributes;for(const i in r){if(void 0===t.attributes[i])continue;const s=r[i].array,n=t.attributes[i],o=n.array,a=n.itemSize*e,h=Math.min(o.length,s.length-a);for(let t=0,e=a;t<h;t++,e++)s[e]=o[t]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let e=0,r=t.count;e<r;e++)Wt.fromBufferAttribute(t,e),Wt.normalize(),t.setXYZ(e,Wt.x,Wt.y,Wt.z)},toNonIndexed:function(){function t(t,e){const r=t.array,i=t.itemSize,s=t.normalized,n=new r.constructor(e.length*i);let o=0,a=0;for(let t=0,s=e.length;t<s;t++){o=e[t]*i;for(let t=0;t<i;t++)n[a++]=r[o++]}return new Nt(n,i,s)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const e=new Yt,r=this.index.array,i=this.attributes;for(const s in i){const n=t(i[s],r);e.setAttribute(s,n)}const s=this.morphAttributes;for(const i in s){const n=[],o=s[i];for(let e=0,i=o.length;e<i;e++){const i=t(o[e],r);n.push(i)}e.morphAttributes[i]=n}e.morphTargetsRelative=this.morphTargetsRelative;const n=this.groups;for(let t=0,r=n.length;t<r;t++){const r=n[t];e.addGroup(r.start,r.count,r.materialIndex)}return e},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const e=this.parameters;for(const r in e)void 0!==e[r]&&(t[r]=e[r]);return t}t.data={attributes:{}};const e=this.index;null!==e&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const r=this.attributes;for(const e in r){const i=r[e],s=i.toJSON(t.data);""!==i.name&&(s.name=i.name),t.data.attributes[e]=s}const i={};let s=!1;for(const e in this.morphAttributes){const r=this.morphAttributes[e],n=[];for(let e=0,i=r.length;e<i;e++){const i=r[e],s=i.toJSON(t.data);""!==i.name&&(s.name=i.name),n.push(s)}n.length>0&&(i[e]=n,s=!0)}s&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const n=this.groups;n.length>0&&(t.data.groups=JSON.parse(JSON.stringify(n)));const o=this.boundingSphere;return null!==o&&(t.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),t},clone:function(){return(new Yt).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const r=t.index;null!==r&&this.setIndex(r.clone(e));const i=t.attributes;for(const t in i){const r=i[t];this.setAttribute(t,r.clone(e))}const s=t.morphAttributes;for(const t in s){const r=[],i=s[t];for(let t=0,s=i.length;t<s;t++)r.push(i[t].clone(e));this.morphAttributes[t]=r}this.morphTargetsRelative=t.morphTargetsRelative;const n=t.groups;for(let t=0,e=n.length;t<e;t++){const e=n[t];this.addGroup(e.start,e.count,e.materialIndex)}const o=t.boundingBox;null!==o&&(this.boundingBox=o.clone());const a=t.boundingSphere;return null!==a&&(this.boundingSphere=a.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Zt extends Yt{constructor(t=1,e=1,r=1,i=1){super(),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:i};const s=t/2,n=e/2,o=Math.floor(r),a=Math.floor(i),h=o+1,c=a+1,u=t/o,l=e/a,d=[],m=[],p=[],f=[];for(let t=0;t<c;t++){const e=t*l-n;for(let r=0;r<h;r++){const i=r*u-s;m.push(i,-e,0),p.push(0,0,1),f.push(r/o),f.push(1-t/a)}}for(let t=0;t<a;t++)for(let e=0;e<o;e++){const r=e+h*t,i=e+h*(t+1),s=e+1+h*(t+1),n=e+1+h*t;d.push(r,i,n),d.push(i,s,n)}this.setIndex(d),this.setAttribute("position",new jt(m,3)),this.setAttribute("normal",new jt(p,3)),this.setAttribute("uv",new jt(f,2))}}const Qt=(t,e)=>e.some(e=>t instanceof e);let Jt,$t;const Kt=new WeakMap,te=new WeakMap,ee=new WeakMap,re=new WeakMap,ie=new WeakMap;let se={get(t,e,r){if(t instanceof IDBTransaction){if("done"===e)return te.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ee.get(t);if("store"===e)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ae(t[e])},set:(t,e,r)=>(t[e]=r,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function ne(t){return t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?($t||($t=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(he(this),e),ae(Kt.get(this))}:function(...e){return ae(t.apply(he(this),e))}:function(e,...r){const i=t.call(he(this),e,...r);return ee.set(i,e.sort?e.sort():[e]),ae(i)}}function oe(t){return"function"==typeof t?ne(t):(t instanceof IDBTransaction&&function(t){if(te.has(t))return;const e=new Promise((e,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",n),t.removeEventListener("abort",n)},s=()=>{e(),i()},n=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",n),t.addEventListener("abort",n)});te.set(t,e)}(t),Qt(t,Jt||(Jt=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,se):t)}function ae(t){if(t instanceof IDBRequest)return function(t){const e=new Promise((e,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",n)},s=()=>{e(ae(t.result)),i()},n=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",n)});return e.then(e=>{e instanceof IDBCursor&&Kt.set(e,t)}).catch(()=>{}),ie.set(e,t),e}(t);if(re.has(t))return re.get(t);const e=oe(t);return e!==t&&(re.set(t,e),ie.set(e,t)),e}const he=t=>ie.get(t);const ce=["get","getKey","getAll","getAllKeys","count"],ue=["put","add","delete","clear"],le=new Map;function de(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(le.get(e))return le.get(e);const r=e.replace(/FromIndex$/,""),i=e!==r,s=ue.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!ce.includes(r))return;const n=async function(t,...e){const n=this.transaction(t,s?"readwrite":"readonly");let o=n.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[r](...e),s&&n.done]))[0]};return le.set(e,n),n}se=(t=>({...t,get:(e,r,i)=>de(e,r)||t.get(e,r,i),has:(e,r)=>!!de(e,r)||t.has(e,r)}))(se);var me=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;u()(this,t),this.name=e,this.version=r;var i="chunks-".concat(e);this.storeName=i,this.disabled=!1,this.db=function(t,e,{blocked:r,upgrade:i,blocking:s,terminated:n}={}){const o=indexedDB.open(t,e),a=ae(o);return i&&o.addEventListener("upgradeneeded",t=>{i(ae(o.result),t.oldVersion,t.newVersion,ae(o.transaction))}),r&&o.addEventListener("blocked",()=>r()),a.then(t=>{n&&t.addEventListener("close",()=>n()),s&&t.addEventListener("versionchange",()=>s())}).catch(()=>{}),a}("mapcache",r,{upgrade:function(t){t.createObjectStore(i,{keyPath:["x","z"]})}})}var e,r,i;return d()(t,[{key:"saveChunk",value:(i=o()(s.a.mark(function t(e,r,i){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.disabled){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.db;case 4:t.t0=this.storeName,t.t1={x:e,z:r,chunkData:i,modified:Date.now()},t.sent.put(t.t0,t.t1);case 7:case"end":return t.stop()}},t,this)})),function(t,e,r){return i.apply(this,arguments)})},{key:"loadChunk",value:(r=o()(s.a.mark(function t(e,r){var i;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.disabled){t.next=2;break}return t.abrupt("return",null);case 2:return t.next=4,this.db;case 4:return t.t0=this.storeName,t.t1=[e,r],t.next=8,t.sent.get(t.t0,t.t1);case 8:return i=t.sent,t.abrupt("return",i&&i.chunkData||null);case 10:case"end":return t.stop()}},t,this)})),function(t,e){return r.apply(this,arguments)})},{key:"clear",value:(e=o()(s.a.mark(function t(){return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.disabled){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.db;case 4:t.t0=this.storeName,t.sent.clear(t.t0);case 6:case"end":return t.stop()}},t,this)})),function(){return e.apply(this,arguments)})}]),t}(),pe=r(8),fe=r.n(pe),ye=r(9),xe=r.n(ye),ge=r(10),be=function(t,e){return function(t){var e=t.seed,r=t.scale,i=void 0===r?100:r,s=t.octaves,n=void 0===s?8:s,o=t.persistance,a=void 0===o?.5:o,h=t.lacunarity,c=void 0===h?2:h,u=t.offset,l=void 0===u?{x:0,y:0}:u;i<=0&&(i=1e-4);for(var d=new Float32Array(16384),m=new fe.a(e),p=new xe.a(e),f=0,y=1,x=[],g=0;g<n;g++){var b=2e5*m.quick()-1e5+l.x,v=2e5*m.quick()-1e5-l.y;x.push({x:b,y:v}),f+=y,y*=a}for(var w=0;w<128;w++)for(var M=0;M<128;M++){y=1;for(var z=1,_=0,A=0;A<n;A++){var S=(M-64+x[A].x)/i*z,k=(w-64+x[A].y)/i*z;_+=p.noise2D(S,k)*y,y*=a,z*=c}d[128*M+w]=Math.max(0,(_+1)/(1.16*f))}return d}({seed:"a-19sdfu428",offset:{x:127*e,y:127*-t}})},ve=r.n(ge)()(1,0,.85,.85),we=[{d:.3,c:3367874},{d:.35,c:3630791},{d:.4,c:13685120},{d:.55,c:5740312},{d:.6,c:4155925},{d:.7,c:6112318},{d:.9,c:5061434},{d:100,c:16776959}],Me=function(t){for(var e=0,r=we;e<r.length;e++){var i=r[e],s=i.d,n=i.c;if(t<=s)return n}return 0};function ze(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)}return r}var _e=new me("world1"),Ae=new class extends _t{constructor(t,e,r,i){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:r,heightSegments:i},this.fromBufferGeometry(new Zt(t,e,r,i)),this.mergeVertices()}}(256,256,127,127);Ae.rotateX(-Math.PI/2);new(function(){function t(){u()(this,t),this.data={}}return d()(t,[{key:"start",value:function(t){this.data[t]=performance.now()}},{key:"end",value:function(t){var e=this.data[t],r=performance.now();if(null!=e&&e<=r){var i=r-e;console.log("PERF(".concat(t,"): ").concat(i,"ms"))}delete this.data[t]}},{key:"measure",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"?";this.start(e);var r=t();return this.end(e),r}}]),t}());var Se=function(t,e){var r=be(t,e),i=function(t){for(var e,r=new Uint32Array(32258),i=0;i<127;i++)for(var s=0;s<127;s++){var n=t[128*i+s],o=t[128*i+s+1],a=t[128*(i+1)+s],h=t[128*(i+1)+s+1],c=2*i*127+2*s;r[c]=r[c+1]=Me((e=[o,h,a,n]).reduce(function(t,e){return t+e},0)/e.length)}return r}(r);r=function(t){for(var e=0;e<t.length;e++)t[e]=60*ve(t[e]);return t}(r);for(var s=Ae.clone(),n=0,o=0;n<r.length;n++,o+=6)s.vertices[n].y=r[n];for(var a=(new Yt).fromGeometry(s),c=a.attributes.color.array,u=0,l=0;u<i.length;u++,l+=9){var d=i[u];c[l]=c[l+3]=c[l+6]=.00390625*(d>>16&255),c[l+1]=c[l+4]=c[l+7]=.00390625*(d>>8&255),c[l+2]=c[l+5]=c[l+8]=.00390625*(255&d)}var m=function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=0|Math.sqrt(t.length),i=0;i<r;i++)for(var s=0;s<r;s++)e[i*r+s]=t[s*r+i];return e}(r,new Float32Array(16384));return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ze(r,!0).forEach(function(e){h()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ze(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},a.attributes,{heightsArray:m})},ke=function(){var t=o()(s.a.mark(function t(e){var r,i,n,o,a,h,c,u,l;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.x,i=e.z,t.prev=1,t.next=4,_e.loadChunk(r,i);case 4:n=t.sent,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.warn("loadChunk",t.t0);case 10:if(n){t.next=20;break}return n=Se(r,i),t.prev=12,t.next=15,_e.saveChunk(r,i,n);case 15:t.next=20;break;case 17:t.prev=17,t.t1=t.catch(12),console.warn("saveChunk",t.t1);case 20:a=(o=n).position,h=o.color,c=o.uv,u=o.normal,l=o.heightsArray,self.postMessage({cmd:"terrain",x:r,z:i,attributes:n},[a.array.buffer,h.array.buffer,c.array.buffer,u.array.buffer,l.buffer]);case 22:case"end":return t.stop()}},t,null,[[1,7],[12,17]])}));return function(e){return t.apply(this,arguments)}}();self.onmessage=function(t){var e=t.data;switch(e.cmd){case"loadChunk":ke(e);break;case"clearCache":_e.clear().catch(function(t){return console.warn("clearCache",t)})}}}]);